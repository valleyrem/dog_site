{% load static %}
{% load woof_tags %}
{% load filters %}
{% load compress %}

<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NJCSC592');</script>
    <!-- End Google Tag Manager -->

    <meta name="description" content="Woof Dogs. Website about dog breeds categorizes by American Kennel Club (AKC).">
    <title>{{title}}</title>

    <!-- Compress local stylesheets -->
    {% compress css %}
    <link rel="stylesheet" type="text/css" href="{% static 'woof/css/styles.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'woof/css/mobile.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'woof/css/dark.css' %}">
    {% endcompress %}

    <!-- Preload external stylesheets -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"></noscript>

    <!-- Preconnect to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Preload and use swap for fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400&display=swap" rel="stylesheet" type="text/css">

    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="{% static 'woof/js/scripts.js' %}" defer></script>
    <script src="https://unpkg.com/htmx.org@1.8.5"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Apply fonts with font-display: swap -->
    <style>
        body, html {
            font-family: 'Montserrat', sans-serif;
            font-display: swap;
        }
    </style>
</head>

<body>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJCSC592');</script>
<!-- End Google Tag Manager -->

<script>
        document.addEventListener("DOMContentLoaded", function() {
            // При начальной загрузке добавить класс темы из localStorage
            const currentTheme = localStorage.getItem('theme') || 'light';
            document.body.classList.add(currentTheme + '-theme');

            // Удалить класс .hidden после применения темы
            document.body.classList.remove('hidden');

            document.querySelector('#theme-toggle').addEventListener('click', function() {
                let newTheme = document.body.classList.contains('light-theme') ? 'dark' : 'light';
                document.body.classList.remove('light-theme', 'dark-theme');
                document.body.classList.add(newTheme + '-theme');
                localStorage.setItem('theme', newTheme);
            });
        });

        // Скрыть контент до применения темы
        document.body.classList.add('hidden');
</script>

{% block mainmenu %}
<div class="header">
    <ul id="mainmenu" class="mainmenu">
        <li class="logo">
            <a href="{% url 'home' %}">
                <div class="logo-text">
                    <span class="letter letter-w">Woof</span>
                    <span class="letter letter-d">Dogs</span>
                </div>
            </a>
        </li>

        {% for m in menu %}
            {% if m.url_name == 'about' or m.url_name == 'contact' %}
                {% if request.resolver_match.url_name == m.url_name %}
                    <li class="selected"><a href="{% url m.url_name %}">{{ m.title }}</a></li>
                {% else %}
                    <li><a href="{% url m.url_name %}">{{ m.title }}</a></li>
                {% endif %}
            {% elif request.user.is_authenticated %}
                {% if request.resolver_match.url_name == m.url_name %}
                    <li class="selected"><a href="{% url m.url_name %}">{{ m.title }}</a></li>
                {% else %}
                    <li><a href="{% url m.url_name %}">{{ m.title }}</a></li>
                {% endif %}
            {% endif %}
        {% endfor %}

        {% if request.user.is_authenticated %}
    <li class="last">

        <a href="http://0.0.0.0:8000/my-posts/" class="circle-link{% if request.path == '/my-posts/' %} selected{% endif %}" title="My posts">
            <i class="bi bi-suit-heart"></i>
        </a> |
        <a href="{% url 'logout' %}" class="logout-link{% if request.path == '/logout/' %} selected{% endif %}">Log out</a>
        <button id="theme-toggle" title="Change theme"><i class="bi bi-circle-half"></i></button>
    </li>
{% else %}
    <li class="last">
        <a href="{% url 'register' %}" class="register-link{% if request.path == '/register/' %} selected{% endif %}">Registration</a> |
        <a href="{% url 'login' %}" class="login-link{% if request.path == '/login/' %} selected{% endif %}">Log in</a>
        <button id="theme-toggle" title="Change theme"><i class="bi bi-circle-half"></i></button>
    </li>
{% endif %}

    </ul>
    <div class="clear"></div>
</div>
{% endblock mainmenu %}

<table class="table-content" border="0" cellpadding="0" cellspacing="0">
<tr>
<!-- Sidebar left -->
<td valign="top" class="left-chapters">
    <div class="hamburger-menu">
  <input id="menu__toggle" type="checkbox" />
  <label class="menu__btn" for="menu__toggle">
    <span></span>
  </label>
  <ul class="menu__box">
    {% if request.resolver_match.url_name == 'home' and cat_selected == 0 %}
  <li class="menu__item selected">All</li>
{% else %}
  <li class="menu__item"><a href="{% url 'home' %}">All</a></li>
{% endif %}

    {% for category in cats %}
      {% if category.pk != 10 %}
        {% if category.pk == cat_selected %}
          <li class="menu__item selected">{{ category.name }}</li>
        {% else %}
          <li class="menu__item"><a href="{{ category.get_absolute_url }}">{{ category.name }}</a></li>
        {% endif %}
      {% endif %}
    {% endfor %}

    <!-- Отдельно выводим категорию с id = 10 -->
    {% with last_category=cats|get_item_by_id:10 %}
      {% if last_category %}
        {% if last_category.pk == cat_selected %}
          <li class="menu__item selected">{{ last_category.name }}</li>
        {% else %}
          <li class="menu__item"><a href="{{ last_category.get_absolute_url }}">{{ last_category.name }}</a></li>
        {% endif %}
      {% endif %}
    {% endwith %}
  </ul>
</div>
</td>
<!-- End Sidebar -->



<td valign="top" class="content">
    <div class="content-text">
        {% block content %}
        {% endblock %}
        {% if request.resolver_match.url_name != 'about' %}
        {% if page_obj.has_other_pages %}
        <nav class="list-pages">
            <ul>
                {% if page_obj.has_previous %}
                <li class="page-num">
                    <a href="?page={{ page_obj.previous_page_number }}"><i class="bi bi-arrow-left" title="Previous"></i></a>
                </li>
                {% endif %}

                {% for p in paginator.page_range %}
                {% if page_obj.number == p %}
                <li class="page-num page-num-selected">{{ p }}</li>
                {% elif p >= page_obj.number|add:-2 and p <= page_obj.number|add:2 %}
                <li class="page-num">
                    <a href="?page={{ p }}">{{ p }}</a>
                </li>
                {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                <li class="page-num">
                    <a href="?page={{ page_obj.next_page_number }}"><i class="bi bi-arrow-right" title="Next"></i></a>
                </li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
        {% endif %}
    </div>
</td></tr></table>
</td></tr>

<!-- Footer -->
<tr><td valign="top">
    <div id="footer">
    <button id="scroll-to-top" title="Go to top"><i class="bi bi-arrow-up-circle"></i></button>
    <div class="footer-section">
        <p class="rights">&copy; 2024 Woof Dogs. All rights reserved</p>
    </div><div class="footer-section">
        <a href="#" class="link-site" aria-label="GitHub"><i class="bi bi-github"></i></a>
            <a href="#" class="link-site" aria-label="Email"><i class="bi bi-envelope"></i></a>
    </div>

    <div class="footer-section">
        <p class="policies">
            <a href="{% url 'privacy-policy' %}">Privacy Policy</a>
            <a href="{% url 'cookie-policy' %}">Cookie Policy</a>
            <a href="{% url 'terms-of-use' %}">Terms of Use</a>
        </p>
    </div>

</div>
</td></tr>
</table>

<!-- End footer and page -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJCSC592"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
</body>
</html>